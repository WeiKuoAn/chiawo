(function(g){function W(B){var o,d,v,h,s=1,f=!1,i={};function O(r,n,t){var a=null;if(y(n)&&(m(n),M(r),x(r),S(n),d>=2)){var e=w(n),l=0,u=A();typeof i[n.bars.order]>"u"&&(D(e)?i[n.bars.order]=-1*b(o,e-1,Math.floor(d/2)-1)-u:i[n.bars.order]=b(o,Math.ceil(d/2),e-2)+u+h*2),l=i[n.bars.order],a=V(t,n,l),t.points=a}return a}function y(r){return r.bars!=null&&r.bars.show&&r.bars.order!=null}function M(r){var n=f?r.getPlaceholder().innerHeight():r.getPlaceholder().innerWidth(),t=f?c(r.getData(),1):c(r.getData(),0),a=t[1]-t[0];s=a/n}function c(r,n){for(var t=new Array,a=0;a<r.length;a++)t[0]=r[a].data[0]?r[a].data[0][n]:null,t[1]=r[a].data[r[a].data.length-1]?r[a].data[r[a].data.length-1][n]:null;return t}function x(r){o=z(r.getData()),d=o.length}function z(r){for(var n=new Array,t=[],a=0;a<r.length;a++)r[a].bars.order!=null&&r[a].bars.show&&t.indexOf(r[a].bars.order)<0&&(t.push(r[a].bars.order),n.push(r[a]));return n.sort(P)}function P(r,n){var t=r.bars.order,a=n.bars.order;return t<a?-1:t>a?1:0}function S(r){v=typeof r.bars.lineWidth<"u"?r.bars.lineWidth:2,h=v*s}function m(r){r.bars.horizontal&&(f=!0)}function w(r){for(var n=0,t=0;t<o.length;++t)if(r==o[t]){n=t;break}return n+1}function A(){var r=0;return d%2!=0&&(r=o[Math.ceil(d/2)].bars.barWidth/2),r}function D(r){return r<=Math.ceil(d/2)}function b(r,n,t){for(var a=0,e=n;e<=t;e++)a+=r[e].bars.barWidth+h*2;return a}function V(r,n,t){for(var a=r.pointsize,e=r.points,l=0,u=f?1:0;u<e.length;u+=a)e[u]+=t,n.data[l][3]=e[u],l++;return e}B.hooks.processDatapoints.push(O)}var p={series:{bars:{order:null}}};g.plot.plugins.push({init:W,options:p,name:"orderBars",version:"0.2"})})(jQuery);
