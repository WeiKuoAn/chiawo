(function(j){var q={series:{stack:null}};function O(M){function Q(w,f){for(var u=null,l=0;l<f.length&&w!=f[l];++l)f[l].stack==w.stack&&(u=f[l]);return u}function S(w,f,u){if(!(f.stack==null||f.stack===!1)){var l=Q(f,w.getData());if(l){for(var e=u.pointsize,s=u.points,c=l.datapoints.pointsize,p=l.datapoints.points,n=[],k,b,D,h,a,g,v=f.lines.show,z=f.bars.horizontal,A=e>2&&(z?u.format[2].x:u.format[2].y),B=v&&f.lines.steps,x=!0,y=z?1:0,m=z?0:1,i=0,r=0,o,t;!(i>=s.length);){if(o=n.length,s[i]==null){for(t=0;t<e;++t)n.push(s[i+t]);i+=e}else if(r>=p.length){if(!v)for(t=0;t<e;++t)n.push(s[i+t]);i+=e}else if(p[r]==null){for(t=0;t<e;++t)n.push(null);x=!0,r+=c}else{if(k=s[i+y],b=s[i+m],h=p[r+y],a=p[r+m],g=0,k==h){for(t=0;t<e;++t)n.push(s[i+t]);n[o+m]+=a,g=a,i+=e,r+=c}else if(k>h){if(v&&i>0&&s[i-e]!=null){for(D=b+(s[i-e+m]-b)*(h-k)/(s[i-e+y]-k),n.push(h),n.push(D+a),t=2;t<e;++t)n.push(s[i+t]);g=a}r+=c}else{if(x&&v){i+=e;continue}for(t=0;t<e;++t)n.push(s[i+t]);v&&r>0&&p[r-c]!=null&&(g=a+(p[r-c+m]-a)*(k-h)/(p[r-c+y]-h)),n[o+m]+=g,i+=e}x=!1,o!=n.length&&A&&(n[o+2]+=g)}if(B&&o!=n.length&&o>0&&n[o]!=null&&n[o]!=n[o-e]&&n[o+1]!=n[o-e+1]){for(t=0;t<e;++t)n[o+e+t]=n[o+t];n[o+1]=n[o-e+1]}}u.points=n}}}M.hooks.processDatapoints.push(S)}j.plot.plugins.push({init:O,options:q,name:"stack",version:"1.2"})})(jQuery);
