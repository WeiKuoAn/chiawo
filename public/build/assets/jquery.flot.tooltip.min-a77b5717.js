(function(p){var C={tooltip:{show:!1,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,snap:!0,lines:!1,clickTips:!1,onHover:function(e,t){},$compat:!1}};C.tooltipOpts=C.tooltip;var h=function(e){this.tipPosition={x:0,y:0},this.init(e)};h.prototype.init=function(e){function t(o){var s={};s.x=o.pageX,s.y=o.pageY,e.setTooltipPosition(s)}function l(o,s,y){i.clickmode?(p(e.getPlaceholder()).bind("plothover",a),e.hideTooltip(),i.clickmode=!1):(a(o,s,y),i.getDomElement().is(":visible")&&(p(e.getPlaceholder()).unbind("plothover",a),i.clickmode=!0))}function a(o,s,y){var f=function(m,n,x,r){return Math.sqrt((x-m)*(x-m)+(r-n)*(r-n))},T=function(m,n,x,r,d,u,c){if(!c||(c=function(L,A,$,F,N,X){if(typeof $<"u")return{x:$,y:A};if(typeof F<"u")return{x:L,y:F};var H,M=-1/((X-F)/(N-$));return{x:H=(N*(L*M-A+F)+$*(L*-M+A-X))/(M*(N-$)+F-X),y:M*H-M*L+A}}(m,n,x,r,d,u),c.x>=Math.min(x,d)&&c.x<=Math.max(x,d)&&c.y>=Math.min(r,u)&&c.y<=Math.max(r,u))){var g=r-u,k=d-x,D=x*u-r*d;return Math.abs(g*m+k*n+D)/Math.sqrt(g*g+k*k)}var I=f(m,n,x,r),R=f(m,n,d,u);return I>R?R:I};if(y)e.showTooltip(y,i.tooltipOptions.snap?y:s);else if(i.plotOptions.series.lines.show&&i.tooltipOptions.lines===!0){var w=i.plotOptions.grid.mouseActiveRadius,v={distance:w+1},E=s;p.each(e.getData(),function(m,n){for(var x=0,r=-1,d=1;d<n.data.length;d++)n.data[d-1][0]<=s.x&&n.data[d][0]>=s.x&&(x=d-1,r=d);if(r===-1)return void e.hideTooltip();var u={x:n.data[x][0],y:n.data[x][1]},c={x:n.data[r][0],y:n.data[r][1]},g=T(n.xaxis.p2c(s.x),n.yaxis.p2c(s.y),n.xaxis.p2c(u.x),n.yaxis.p2c(u.y),n.xaxis.p2c(c.x),n.yaxis.p2c(c.y),!1);if(g<v.distance){var k=f(u.x,u.y,s.x,s.y)<f(s.x,s.y,c.x,c.y)?x:r,D=(n.datapoints.pointsize,[s.x,u.y+(c.y-u.y)*((s.x-u.x)/(c.x-u.x))]),I={datapoint:D,dataIndex:k,series:n,seriesIndex:m};v={distance:g,item:I},i.tooltipOptions.snap&&(E={pageX:n.xaxis.p2c(D[0]),pageY:n.yaxis.p2c(D[1])})}}),v.distance<w+1?e.showTooltip(v.item,E):e.hideTooltip()}else e.hideTooltip()}var i=this,O=p.plot.plugins.length;if(this.plotPlugins=[],O)for(var P=0;O>P;P++)this.plotPlugins.push(p.plot.plugins[P].name);e.hooks.bindEvents.push(function(o,s){i.plotOptions=o.getOptions(),typeof i.plotOptions.tooltip=="boolean"&&(i.plotOptions.tooltipOpts.show=i.plotOptions.tooltip,i.plotOptions.tooltip=i.plotOptions.tooltipOpts,delete i.plotOptions.tooltipOpts),i.plotOptions.tooltip.show!==!1&&typeof i.plotOptions.tooltip.show<"u"&&(i.tooltipOptions=i.plotOptions.tooltip,i.tooltipOptions.$compat?(i.wfunc="width",i.hfunc="height"):(i.wfunc="innerWidth",i.hfunc="innerHeight"),i.getDomElement(),p(o.getPlaceholder()).bind("plothover",a),i.tooltipOptions.clickTips&&p(o.getPlaceholder()).bind("plotclick",l),i.clickmode=!1,p(s).bind("mousemove",t))}),e.hooks.shutdown.push(function(o,s){p(o.getPlaceholder()).unbind("plothover",a),p(o.getPlaceholder()).unbind("plotclick",l),o.removeTooltip(),p(s).unbind("mousemove",t)}),e.setTooltipPosition=function(o){var s=i.getDomElement(),y=s.outerWidth()+i.tooltipOptions.shifts.x,f=s.outerHeight()+i.tooltipOptions.shifts.y;o.x-p(window).scrollLeft()>p(window)[i.wfunc]()-y&&(o.x-=y,o.x=Math.max(o.x,0)),o.y-p(window).scrollTop()>p(window)[i.hfunc]()-f&&(o.y-=f),isNaN(o.x)?i.tipPosition.x=i.tipPosition.xPrev:(i.tipPosition.x=o.x,i.tipPosition.xPrev=o.x),isNaN(o.y)?i.tipPosition.y=i.tipPosition.yPrev:(i.tipPosition.y=o.y,i.tipPosition.yPrev=o.y)},e.showTooltip=function(o,s,y){var f=i.getDomElement(),T=i.stringFormat(i.tooltipOptions.content,o);T!==""&&(f.html(T),e.setTooltipPosition({x:i.tipPosition.x,y:i.tipPosition.y}),f.css({left:i.tipPosition.x+i.tooltipOptions.shifts.x,top:i.tipPosition.y+i.tooltipOptions.shifts.y}).show(),typeof i.tooltipOptions.onHover=="function"&&i.tooltipOptions.onHover(o,f))},e.hideTooltip=function(){i.getDomElement().hide().html("")},e.removeTooltip=function(){i.getDomElement().remove()}},h.prototype.getDomElement=function(){var e=p("<div>");return this.tooltipOptions&&this.tooltipOptions.cssClass&&(e=p("."+this.tooltipOptions.cssClass),e.length===0&&(e=p("<div />").addClass(this.tooltipOptions.cssClass),e.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"}))),e},h.prototype.stringFormat=function(e,t){var l,a,i,O,P,o=/%p\.{0,1}(\d{0,})/,s=/%s/,y=/%c/,f=/%lx/,T=/%ly/,w=/%x\.{0,1}(\d{0,})/,v=/%y\.{0,1}(\d{0,})/,E="%x",m="%y",n="%ct",x="%n";if(typeof t.series.threshold<"u"?(l=t.datapoint[0],a=t.datapoint[1],i=t.datapoint[2]):typeof t.series.curvedLines<"u"?(l=t.datapoint[0],a=t.datapoint[1]):typeof t.series.lines<"u"&&t.series.lines.steps?(l=t.series.datapoints.points[2*t.dataIndex],a=t.series.datapoints.points[2*t.dataIndex+1],i=""):(l=t.series.data[t.dataIndex][0],a=t.series.data[t.dataIndex][1],i=t.series.data[t.dataIndex][2]),t.series.label===null&&t.series.originSeries&&(t.series.label=t.series.originSeries.label),typeof e=="function"&&(e=e(t.series.label,l,a,t)),typeof e=="boolean"&&!e)return"";if(i&&(e=e.replace(n,i)),typeof t.series.percent<"u"?O=t.series.percent:typeof t.series.percents<"u"&&(O=t.series.percents[t.dataIndex]),typeof O=="number"&&(e=this.adjustValPrecision(o,e,O)),t.series.hasOwnProperty("pie")&&typeof t.series.data[0][1]<"u"&&(P=t.series.data[0][1]),typeof P=="number"&&(e=e.replace(x,P)),e=typeof t.series.label<"u"?e.replace(s,t.series.label):e.replace(s,""),e=typeof t.series.color<"u"?e.replace(y,t.series.color):e.replace(y,""),e=this.hasAxisLabel("xaxis",t)?e.replace(f,t.series.xaxis.options.axisLabel):e.replace(f,""),e=this.hasAxisLabel("yaxis",t)?e.replace(T,t.series.yaxis.options.axisLabel):e.replace(T,""),this.isTimeMode("xaxis",t)&&this.isXDateFormat(t)&&(e=e.replace(w,this.timestampToDate(l,this.tooltipOptions.xDateFormat,t.series.xaxis.options))),this.isTimeMode("yaxis",t)&&this.isYDateFormat(t)&&(e=e.replace(v,this.timestampToDate(a,this.tooltipOptions.yDateFormat,t.series.yaxis.options))),typeof l=="number"&&(e=this.adjustValPrecision(w,e,l)),typeof a=="number"&&(e=this.adjustValPrecision(v,e,a)),typeof t.series.xaxis.ticks<"u"){var r;r=this.hasRotatedXAxisTicks(t)?"rotatedTicks":"ticks";var d=t.dataIndex+t.seriesIndex;for(var u in t.series.xaxis[r])if(t.series.xaxis[r].hasOwnProperty(d)&&!this.isTimeMode("xaxis",t)){var c=this.isCategoriesMode("xaxis",t)?t.series.xaxis[r][d].label:t.series.xaxis[r][d].v;c===l&&(e=e.replace(w,t.series.xaxis[r][d].label.replace(/\$/g,"$$$$")))}}if(typeof t.series.yaxis.ticks<"u"){for(var g in t.series.yaxis.ticks)if(t.series.yaxis.ticks.hasOwnProperty(g)){var k=this.isCategoriesMode("yaxis",t)?t.series.yaxis.ticks[g].label:t.series.yaxis.ticks[g].v;k===a&&(e=e.replace(v,t.series.yaxis.ticks[g].label.replace(/\$/g,"$$$$")))}}return typeof t.series.xaxis.tickFormatter<"u"&&(e=e.replace(E,t.series.xaxis.tickFormatter(l,t.series.xaxis).replace(/\$/g,"$$"))),typeof t.series.yaxis.tickFormatter<"u"&&(e=e.replace(m,t.series.yaxis.tickFormatter(a,t.series.yaxis).replace(/\$/g,"$$"))),e},h.prototype.isTimeMode=function(e,t){return typeof t.series[e].options.mode<"u"&&t.series[e].options.mode==="time"},h.prototype.isXDateFormat=function(e){return typeof this.tooltipOptions.xDateFormat<"u"&&this.tooltipOptions.xDateFormat!==null},h.prototype.isYDateFormat=function(e){return typeof this.tooltipOptions.yDateFormat<"u"&&this.tooltipOptions.yDateFormat!==null},h.prototype.isCategoriesMode=function(e,t){return typeof t.series[e].options.mode<"u"&&t.series[e].options.mode==="categories"},h.prototype.timestampToDate=function(e,t,l){var a=p.plot.dateGenerator(e,l);return p.plot.formatDate(a,t,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},h.prototype.adjustValPrecision=function(e,t,l){var a,i=t.match(e);return i!==null&&RegExp.$1!==""&&(a=RegExp.$1,l=l.toFixed(a),t=t.replace(e,l)),t},h.prototype.hasAxisLabel=function(e,t){return p.inArray("axisLabels",this.plotPlugins)!==-1&&typeof t.series[e].options.axisLabel<"u"&&t.series[e].options.axisLabel.length>0},h.prototype.hasRotatedXAxisTicks=function(e){return p.inArray("tickRotor",this.plotPlugins)!==-1&&typeof e.series.xaxis.rotatedTicks<"u"};var Y=function(e){new h(e)};p.plot.plugins.push({init:Y,options:C,name:"tooltip",version:"0.8.5"})})(jQuery);
